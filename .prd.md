---
id: prd-gate-test-suite
version: 1.0.0
created: 2026-01-23
updated: 2026-01-23
changelog:
  - 1.0.0: 初始版本
---

# PRD - Gate Test Suite（检查系统自测）

Priority: P0

## 目标

为检查系统建立"兜底"测试，确保灾难级误放行不会发生。

## 背景

问题：每次审计换个视角就能挖出新坑，永远弄不完。
根因：没有"可封顶、可收口"的审计体系。

解决方案：三层边界 + Gate Test Suite
- A 层：Release Blocker（7 个，必须修 + 自动化测试）
- B 层：Known Issues（6 个，记录触发条件，不阻塞）
- C 层：Hygiene（优化，不管）

## A 层问题清单（必须修）

| ID | 文件 | 问题 | 灾难类型 |
|----|------|------|---------|
| A1 | pr-gate-v2.sh:539 | 空 DoD 也会通过 | 误放行 |
| A2 | pr-gate-v2.sh:444 | QA 决策只校验存在不校验内容 | 假绿 |
| A3 | detect-priority.cjs:67 | P0wer 被误判为 P0 | 高危变低危 |
| A4 | ci.yml:300 | ci-passed 不依赖 release-check | 假绿 |
| A5 | ci.yml:241 | release 模式跳过关键测试 | 假绿 |
| A6 | run-regression.sh:163 | 任意 npm script 可执行 | 安全穿透 |
| A7 | cleanup.sh:77 | checkout 失败后继续删除 | 数据损失 |

## 成功标准

- 7 个 Gate Test 全部通过
- A 层问题全部修复
- B 层问题记录为 Known Issues
- 宣布"检查系统 v1 完成"
