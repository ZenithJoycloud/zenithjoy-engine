---
id: dod-worktree-auto-detect
version: 1.0.0
created: 2026-01-31
updated: 2026-01-31
changelog:
  - 1.0.0: 初始版本
---

## DoD - Worktree 自动检测与创建

### 验收清单

- [ ] 新增 `skills/dev/steps/00-worktree-auto.md` 前置步骤
- [ ] 僵尸 .dev-mode 检测（超 2 小时 + session 不活跃 → 清理）
- [ ] 活跃冲突时自动创建 worktree + cd + 安装依赖
- [ ] `skills/dev/steps/02-detect.md` 移除重复的 worktree 检测段
- [ ] `skills/dev/steps/03-branch.md` 冲突兜底改为自动 worktree（不再 exit 1）
- [ ] `skills/dev/scripts/worktree-manage.sh` 创建加 flock 锁
- [ ] `skills/dev/SKILL.md` 更新加载策略和流程图
- [ ] FEATURES.md W6 更新说明
- [ ] 版本号更新（package.json + CHANGELOG.md）
- [ ] CI 通过

### QA 决策

- 测试范围: worktree-manage.sh 的 flock 锁、Step 0 的僵尸检测逻辑
- 风险点: 并发 worktree 创建、僵尸判定误杀活跃 session
