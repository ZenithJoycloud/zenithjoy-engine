# Definition of Done: CI P1 遗留问题修复

参考 QA Decision: `docs/QA-DECISION.md`

## 验收标准

### P1-1: L2A/L2B 结构验证强化

#### L2A 增强
- [ ] PRD 检查：最少 3 个 section (`##`)
  - Test: auto:tests/devgate/l2a-check.test.ts
- [ ] PRD 检查：每个 section 至少 2 行非空内容
  - Test: auto:tests/devgate/l2a-check.test.ts
- [ ] DoD 检查：最少 3 个验收项
  - Test: auto:tests/devgate/l2a-check.test.ts
- [ ] DoD 检查：每个验收项必须有 Test 映射
  - Test: auto:tests/devgate/l2a-check.test.ts

#### L2B 增强
- [ ] Evidence 检查：必须有可复现命令（bash, npm, node, curl）或机器引用
  - Test: auto:tests/devgate/l2b-check.test.ts
- [ ] Evidence 检查：拒绝纯文字描述
  - Test: auto:tests/devgate/l2b-check.test.ts
- [ ] Evidence 检查：截图必须存在且非空
  - Test: auto:tests/devgate/l2b-check.test.ts

### P1-2: RCI 覆盖率匹配收紧

- [ ] 移除 `name.includes()` 误判逻辑
  - Test: auto:tests/ci/scan-rci-coverage.test.ts
- [ ] 实现路径精确匹配
  - Test: auto:tests/ci/scan-rci-coverage.test.ts
- [ ] 实现目录匹配
  - Test: auto:tests/ci/scan-rci-coverage.test.ts
- [ ] 实现 glob 匹配
  - Test: auto:tests/ci/scan-rci-coverage.test.ts
- [ ] 假覆盖被正确检测
  - Test: auto:tests/ci/scan-rci-coverage.test.ts

### 版本和文档

- [ ] 版本号更新：12.2.0 → 12.3.0
  - Test: auto:tests/version-sync.test.ts
- [ ] CHANGELOG 更新：记录 P1-1 和 P1-2 修复
  - Test: manual:changelog-review
- [ ] regression-contract.yaml 版本更新
  - Test: auto:tests/contract-version.test.ts

### 质量检查

- [ ] 所有新增测试通过
  - Test: auto:npm-test
- [ ] TypeScript 编译通过
  - Test: auto:npm-run-typecheck
- [ ] Shell 脚本 shellcheck 通过
  - Test: auto:ci-shellcheck
- [ ] 代码审计通过（L1+L2=0）
  - Test: auto:audit-report

## 完成定义

- 所有验收项 ✅ 完成
- 所有测试通过
- PR 创建并合并到 develop
- CI 全绿

## 引用

- PRD: `.prd.md`
- QA Decision: `docs/QA-DECISION.md`
